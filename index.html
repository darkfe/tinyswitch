<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Tinyswitch : tinyswitch" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Tinyswitch</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/darkfe/tinyswitch">View on GitHub</a>

          <h1 id="project_title">Tinyswitch</h1>
          <h2 id="project_tagline">tinyswitch</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/darkfe/tinyswitch/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/darkfe/tinyswitch/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="tinyswitch" class="anchor" href="#tinyswitch"><span class="octicon octicon-link"></span></a>TinySwitch</h1>

<p>TinySwitch 是一个无聊的低性能的jquery插件,主要用来解决这种场景下的问题:</p>

<ol>
<li>点击 radio A, 隐藏一片区域, 点击radio B, 隐藏这篇区域</li>
<li>勾选 checkbox, 启用一部分控件,  取消勾选 checkbox, 禁用一部分控件</li>
<li>一堆单选框,最后一个选项叫自定义,点击自定义,后面出现一个文本框,并且自动获取焦点,点击其他选项,文本框又消失了</li>
</ol><p>这种无聊并且重复的逻辑大量充斥在各种表单中.</p>

<p>TinySwitch 提供了这样的一种方案来试图简化(或者复杂化?)这个鸟玩意儿.</p>

<p>你只需要在控件上配置:</p>

<pre><code>data-tinyswitch="expr ? action1 : action2 selector"
</code></pre>

<p>就可以操控对应的内容展示隐藏,或者启用禁用,以及其他一些别的什么逻辑.</p>

<ul>
<li>
<code>expr</code>     为判断执行<code>action</code>方式, 目前支持判断<code>checked</code>,<code>value</code>和<code>index</code>.</li>
<li>
<code>selector</code> 为标准的jQuery支持的css选择器, 它告诉<code>TinySwitch</code>, 谁是点击后的操作对象</li>
<li>
<code>action1</code>  当<code>expr</code>结果为<code>true</code>时执行这个行为 </li>
<li>
<code>action2</code>  当<code>expr</code>结果为<code>false</code>时执行这个行为 </li>
</ul><h3>
<a name="%E5%8D%95%E9%80%89%E6%A1%86" class="anchor" href="#%E5%8D%95%E9%80%89%E6%A1%86"><span class="octicon octicon-link"></span></a>单选框</h3>

<p>由于单选框自己不会主动触发<code>取消选中</code>这个行为, 所以单选框只需要配置<code>选中</code>行为, 例如:</p>

<div class="highlight"><pre><span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? show #box"</span><span class="nt">&gt;</span> 显示box
<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"radio"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? hide #box"</span><span class="nt">&gt;</span> 隐藏box
<span class="nt">&lt;/label&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>我是box<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h3>
<a name="%E5%A4%8D%E9%80%89%E6%A1%86" class="anchor" href="#%E5%A4%8D%E9%80%89%E6%A1%86"><span class="octicon octicon-link"></span></a>复选框</h3>

<p>复选框本身会触发两个行为: <code>勾选</code> 和 <code>取消勾选</code>, 所以复选框可以配置两个<code>行为</code>, 例如:</p>

<div class="highlight"><pre><span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? show : hide #box"</span><span class="nt">&gt;</span> 显示或者隐藏box
<span class="nt">&lt;/label&gt;</span> 

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>我是box<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"list"</span><span class="nt">&gt;</span>list<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h3>
<a name="%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8" class="anchor" href="#%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8"><span class="octicon octicon-link"></span></a>下拉列表</h3>

<div class="highlight"><pre><span class="nt">&lt;select</span> <span class="na">data-tinyswitch=</span><span class="s">"value==1 ? show : hide #box"</span><span class="nt">&gt;</span> 
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>value is 1<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>value is 2<span class="nt">&lt;/option&gt;</span>
<span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>我是box<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p><code>value==1 ? show : hide #box</code> 表示:</p>

<ul>
<li>当<code>select</code>的<code>value == 1</code>的时候,执行<code>show</code>这个行为</li>
<li>当<code>select</code>的<code>value != 1</code>的时候,执行<code>hide</code>这个行为 </li>
</ul><p><code>value==1</code> 表达式中的<code>value</code>关键字表示当前<code>select</code>的<code>value</code>值</p>

<p><code>TinySwitch</code> 还支持<code>index</code>关键字,表示当前<code>select</code>的<code>selectIndex</code>索引</p>

<p>表达式中目前支持如下运算符:</p>

<ul>
<li>
<code>==</code>  相等</li>
<li>
<code>!=</code>  不等</li>
<li>
<code>&gt;</code>   大于</li>
<li>
<code>&lt;</code>   小于</li>
<li>
<code>*=</code>  包含</li>
<li>
<code>$=</code>  结尾等于</li>
<li>
<code>^=</code>  开头等于</li>
</ul><p>当与<code>value</code>或者<code>index</code>比较的值不是数字时,需要使用**单引号**将内容包裹起来.</p>

<p>如果在单引号中包含单引号,需要为单引号增加转义符<code>value='a\'b</code>.</p>

<h3>
<a name="%E6%9B%B4%E5%A4%8D%E6%9D%82%E7%9A%84%E9%80%89%E6%8B%A9%E5%99%A8" class="anchor" href="#%E6%9B%B4%E5%A4%8D%E6%9D%82%E7%9A%84%E9%80%89%E6%8B%A9%E5%99%A8"><span class="octicon octicon-link"></span></a>更复杂的选择器</h3>

<p><code>TinySwitch</code> 可以使用<code>jQuery</code>支持的所有<code>css</code>选择器来进行全局的元素定位, 比如:</p>

<div class="highlight"><pre><span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? show : hide #box,#list"</span><span class="nt">&gt;</span> 显示或者隐藏box 和 list
<span class="nt">&lt;/label&gt;</span> 

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>我是box<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"list"</span><span class="nt">&gt;</span>list<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h3>
<a name="%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%85%8D%E7%BD%AE" class="anchor" href="#%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8%E5%A4%9A%E4%B8%AA%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a>同时使用多个配置</h3>

<p>以上的例子中为了简化, 都使用了一个<code>action</code>, <code>TinySwitch</code>也支持用分号分隔多个<code>action</code>按序执行, 例如:</p>

<div class="highlight"><pre><span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? show : hide #box; checked ? show : hide #list"</span><span class="nt">&gt;</span> 显示或者隐藏box 和 list
<span class="nt">&lt;/label&gt;</span> 

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>我是box<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"list"</span><span class="nt">&gt;</span>list<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h3>
<a name="%E5%A4%9A%E4%B8%AAaction%E5%90%8C%E6%97%B6%E6%89%A7%E8%A1%8C" class="anchor" href="#%E5%A4%9A%E4%B8%AAaction%E5%90%8C%E6%97%B6%E6%89%A7%E8%A1%8C"><span class="octicon octicon-link"></span></a>多个<code>action</code>同时执行</h3>

<p><code>TinySwitch</code> 支持多个用<code>&amp;</code>隔开的<code>action</code>, 按序执行</p>

<div class="highlight"><pre><span class="nt">&lt;label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"checkbox"</span> <span class="na">data-tinyswitch=</span><span class="s">"checked ? show&amp;disabled : hide #box"</span><span class="nt">&gt;</span> 显示box,并且禁用box中的控件, 或者隐藏box
<span class="nt">&lt;/label&gt;</span> 

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"box"</span><span class="nt">&gt;</span>
  我是box
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span> 
</pre></div>

<h3>
<a name="%E5%85%A8%E5%B1%80%E5%AE%9A%E4%BD%8D%E5%92%8C%E7%9B%B8%E5%AF%B9%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0" class="anchor" href="#%E5%85%A8%E5%B1%80%E5%AE%9A%E4%BD%8D%E5%92%8C%E7%9B%B8%E5%AF%B9%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0"><span class="octicon octicon-link"></span></a>全局定位和相对定位元素</h3>

<p>默认情况下,写在<code>@</code>前的<code>selector</code>是全局定位的, 即:</p>

<p><code>#box@show</code> 实际上会执行 <code>$('#box').show()</code></p>

<p>但有很多场景中, 我们需要相对于当前控件对目标的容器进行定位, 比如下例:</p>

<div class="highlight"><pre><span class="nt">&lt;select</span> <span class="na">data-tinyswitch=</span><span class="s">"value==1 ? show : hide .list"</span><span class="nt">&gt;</span> 
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>启用<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>禁用<span class="nt">&lt;/option&gt;</span> 
<span class="nt">&lt;/select&gt;</span>  
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"list"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"我是一个文本框"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;select</span> <span class="na">data-tinyswitch=</span><span class="s">"value==1 ? show : hide .list"</span><span class="nt">&gt;</span> 
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>启用<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>禁用<span class="nt">&lt;/option&gt;</span> 
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"list"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"我是一个文本框"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<p>我们希望每个<code>select</code>都只控制它下面的<code>.list</code>,但这样做会导致两个<code>.list</code>同时被控制.</p>

<p>针对这种场景 <code>TinySwitch</code> 提供了一种简单的标记方式来实现相对于当前控件的定位方式:</p>

<pre><code>data-tinyswitch="value==1 ? show : hide next~.list"
</code></pre>

<ul>
<li>
<code>next</code> 表示当前控件的<code>.next()</code>节点</li>
<li>
<code>~</code> 表示相对定位规则结束</li>
</ul><p>相对定位规则支持如下标记:</p>

<ul>
<li>
<code>next</code> </li>
<li><code>prev</code></li>
<li><code>nextAll</code></li>
<li><code>prevAll</code></li>
<li><code>parent</code></li>
</ul><p>你可以组合使用它们,比如:</p>

<pre><code>data-tinyswitch="value==1 ? show : hide parent.next.next~.list"
</code></pre>

<p>对于上面的例子,我们可以写成这样来实现需求:</p>

<div class="highlight"><pre><span class="nt">&lt;select</span> <span class="na">data-tinyswitch=</span><span class="s">"value==1 ? show : hide next~.list"</span><span class="nt">&gt;</span> 
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>启用<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>禁用<span class="nt">&lt;/option&gt;</span> 
<span class="nt">&lt;/select&gt;</span>  
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"list"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"我是一个文本框"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;select</span> <span class="na">data-tinyswitch=</span><span class="s">"value==1 ? show : hide next~.list"</span><span class="nt">&gt;</span> 
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>启用<span class="nt">&lt;/option&gt;</span>
  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"2"</span><span class="nt">&gt;</span>禁用<span class="nt">&lt;/option&gt;</span> 
<span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"list"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">value=</span><span class="s">"我是一个文本框"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>

<h3>
<a name="tinyswitch-%E9%BB%98%E8%AE%A4%E8%87%AA%E5%B8%A6%E7%9A%84action" class="anchor" href="#tinyswitch-%E9%BB%98%E8%AE%A4%E8%87%AA%E5%B8%A6%E7%9A%84action"><span class="octicon octicon-link"></span></a>TinySwitch 默认自带的<code>action</code>
</h3>

<ol>
<li>
<code>show</code>:   显示这个容器</li>
<li>
<code>hide</code>:   隐藏这个容器</li>
<li>
<code>disabled</code> 或者 <code>off</code>:  禁用这个控件, 或者禁用这个容器中的所有控件</li>
<li>
<code>enabled</code>  或者 <code>on</code>:  启用这个控件, 或者启用这个容器中的所有控件</li>
<li>
<code>focus</code>:    让当前的控件获得焦点</li>
</ol><p>你可以通过脚本来增加自定义的<code>action</code></p>

<div class="highlight"><pre><span class="nx">$</span><span class="p">.</span><span class="nx">tinyswitch</span><span class="p">.</span><span class="nx">addAction</span><span class="p">(</span><span class="s1">'clearValues'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">elements</span><span class="p">){</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">elements</span><span class="p">).</span><span class="nx">values</span><span class="p">(</span><span class="s1">''</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="tinyswitch-%E7%9A%84%E4%BA%8B%E4%BB%B6" class="anchor" href="#tinyswitch-%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="octicon octicon-link"></span></a>TinySwitch 的事件</h3>

<p><code>TinySwitch</code>目前只提供两个事件:</p>

<ol>
<li>
<code>tinyswitch.beforeswitch</code> 事件, 如果在这个事件中返回<code>false</code>, 将停止执行<code>switch</code>的操作.</li>
<li>
<code>tinyswitch.afterswitch</code> 事件, <code>switch</code>完成之后触发</li>
</ol><p>例子:</p>

<div class="highlight"><pre>  <span class="nx">$</span><span class="p">(</span><span class="s1">'#xxoo'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'tinyswitch.beforeswitch'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">'xxoo=1'</span><span class="p">)){</span>
      <span class="nx">alert</span><span class="p">(</span><span class="s1">'也不知道这么地,反正当前选项对你禁用了.'</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">checked</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">})</span>
</pre></div>

<div class="highlight"><pre>    <span class="c1">//使用按钮模拟一个switch</span>
    <span class="nx">$</span><span class="p">(</span><span class="s1">'#xxoo'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">'tinyswitch.beforeswitch'</span><span class="p">,</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">'data-tinyswitchvalue'</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span><span class="nx">v</span><span class="p">){</span> <span class="k">return</span> <span class="nx">v</span><span class="o">===</span><span class="s1">'true'</span><span class="o">?</span><span class="s1">'false'</span><span class="o">:</span><span class="s1">'true'</span> <span class="p">})</span>
    <span class="p">});</span>
</pre></div>

<p>演示: <a href="http://darkfe.com/tinyswitch/demo.html">http://darkfe.com/tinyswitch/demo.html</a></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Tinyswitch maintained by <a href="https://github.com/darkfe">darkfe</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
